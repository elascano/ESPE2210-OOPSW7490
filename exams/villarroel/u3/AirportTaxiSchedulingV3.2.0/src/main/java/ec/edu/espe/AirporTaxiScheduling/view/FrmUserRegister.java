package ec.edu.espe.AirporTaxiScheduling.view;

import ec.edu.espe.AirporTaxiScheduling.controller.TraveldbController;
import ec.edu.espe.AirporTaxiScheduling.controller.UserdbController;
import ec.edu.espe.AirporTaxiScheduling.model.User;
import java.util.ArrayList;
import javax.swing.JOptionPane;

/**
 *
 * @author Leonardo Yaranga,Progress Team, DCCO-ESPE
 */
public class FrmUserRegister extends javax.swing.JFrame {

          /**
           * Creates new form FrmUserRegister
           */
          //  User user = new User();
          public FrmUserRegister() {
                    initComponents();
          }

          /**
           * This method is called from within the constructor to initialize the
           * form. WARNING: Do NOT modify this code. The content of this method
           * is always regenerated by the Form Editor.
           */
          @SuppressWarnings("unchecked")
          // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
          private void initComponents() {

                    jPanel1 = new javax.swing.JPanel();
                    jLabel1 = new javax.swing.JLabel();
                    jLabel2 = new javax.swing.JLabel();
                    txtFullName = new javax.swing.JTextField();
                    jLabel3 = new javax.swing.JLabel();
                    jLabel4 = new javax.swing.JLabel();
                    txtMail = new javax.swing.JTextField();
                    txtPhoneNumber = new javax.swing.JTextField();
                    txtPassword = new javax.swing.JTextField();
                    jLabel6 = new javax.swing.JLabel();
                    btnCreateUser = new javax.swing.JButton();
                    btnCancel = new javax.swing.JButton();
                    jLabel5 = new javax.swing.JLabel();
                    txtUserName = new javax.swing.JTextField();
                    btBack = new javax.swing.JButton();

                    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                    setResizable(false);

                    jLabel1.setText("Registrarse");

                    jLabel2.setText("Nombre Completo:");

                    txtFullName.setToolTipText("No se puede ingresar caracteres especiales..");
                    txtFullName.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        txtFullNameActionPerformed(evt);
                              }
                    });
                    txtFullName.addKeyListener(new java.awt.event.KeyAdapter() {
                              public void keyTyped(java.awt.event.KeyEvent evt) {
                                        txtFullNameKeyTyped(evt);
                              }
                    });

                    jLabel3.setText("Correo:");

                    jLabel4.setText("Numero de telefono: ");

                    txtMail.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        txtMailActionPerformed(evt);
                              }
                    });

                    txtPhoneNumber.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        txtPhoneNumberActionPerformed(evt);
                              }
                    });
                    txtPhoneNumber.addKeyListener(new java.awt.event.KeyAdapter() {
                              public void keyTyped(java.awt.event.KeyEvent evt) {
                                        txtPhoneNumberKeyTyped(evt);
                              }
                    });

                    txtPassword.addKeyListener(new java.awt.event.KeyAdapter() {
                              public void keyTyped(java.awt.event.KeyEvent evt) {
                                        txtPasswordKeyTyped(evt);
                              }
                    });

                    jLabel6.setText("Clave:");

                    btnCreateUser.setText("Crear usuario");
                    btnCreateUser.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        btnCreateUserActionPerformed(evt);
                              }
                    });

                    btnCancel.setText("Cancelar");
                    btnCancel.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        btnCancelActionPerformed(evt);
                              }
                    });

                    jLabel5.setText("Nombre de usuario:");

                    txtUserName.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        txtUserNameActionPerformed(evt);
                              }
                    });

                    btBack.setText("<REGRESAR");
                    btBack.addActionListener(new java.awt.event.ActionListener() {
                              public void actionPerformed(java.awt.event.ActionEvent evt) {
                                        btBackActionPerformed(evt);
                              }
                    });

                    javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
                    jPanel1.setLayout(jPanel1Layout);
                    jPanel1Layout.setHorizontalGroup(
                              jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                              .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                  .addGroup(jPanel1Layout.createSequentialGroup()
                                                            .addGap(81, 81, 81)
                                                            .addComponent(btnCreateUser)
                                                            .addGap(42, 42, 42)
                                                            .addComponent(btnCancel))
                                                  .addGroup(jPanel1Layout.createSequentialGroup()
                                                            .addGap(39, 39, 39)
                                                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                      .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                                                .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                                                .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                                                .addComponent(jLabel4))
                                                                      .addComponent(jLabel6)
                                                                      .addComponent(jLabel5))
                                                            .addGap(43, 43, 43)
                                                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                                      .addComponent(txtPassword)
                                                                      .addComponent(txtPhoneNumber, javax.swing.GroupLayout.DEFAULT_SIZE, 135, Short.MAX_VALUE)
                                                                      .addComponent(txtMail)
                                                                      .addComponent(txtFullName)
                                                                      .addComponent(txtUserName)))
                                                  .addGroup(jPanel1Layout.createSequentialGroup()
                                                            .addContainerGap()
                                                            .addComponent(btBack)
                                                            .addGap(99, 99, 99)
                                                            .addComponent(jLabel1)))
                                        .addContainerGap(89, Short.MAX_VALUE))
                    );
                    jPanel1Layout.setVerticalGroup(
                              jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                              .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addGap(17, 17, 17)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                  .addComponent(jLabel1)
                                                  .addComponent(btBack))
                                        .addGap(30, 30, 30)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                  .addComponent(jLabel2)
                                                  .addComponent(txtFullName, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGap(18, 18, 18)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                  .addComponent(txtMail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                  .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGap(20, 20, 20)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                  .addComponent(txtPhoneNumber, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                  .addComponent(jLabel4))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 18, Short.MAX_VALUE)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                  .addComponent(jLabel5)
                                                  .addComponent(txtUserName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                  .addComponent(jLabel6)
                                                  .addComponent(txtPassword, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGap(5, 5, 5)
                                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                  .addComponent(btnCreateUser)
                                                  .addComponent(btnCancel))
                                        .addGap(34, 34, 34))
                    );

                    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
                    getContentPane().setLayout(layout);
                    layout.setHorizontalGroup(
                              layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                              .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    );
                    layout.setVerticalGroup(
                              layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                              .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    );

                    pack();
                    setLocationRelativeTo(null);
          }// </editor-fold>//GEN-END:initComponents

    private void txtMailActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtMailActionPerformed
    }//GEN-LAST:event_txtMailActionPerformed

    private void txtFullNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtFullNameActionPerformed
    }//GEN-LAST:event_txtFullNameActionPerformed

    private void txtFullNameKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtFullNameKeyTyped
              int key = evt.getKeyChar();
              boolean letters = (key >= 65 && key <= 90) || (key >= 97 && key <= 122) || (key == 32);
              if (!letters) {
                        evt.consume();
              }
    }//GEN-LAST:event_txtFullNameKeyTyped

    private void txtPhoneNumberActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPhoneNumberActionPerformed

    }//GEN-LAST:event_txtPhoneNumberActionPerformed

    private void txtPhoneNumberKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPhoneNumberKeyTyped
              int validNumber = evt.getKeyChar();
              boolean number = validNumber >= 48 && validNumber <= 57;
              if (!number) {
                        evt.consume();
              }
              if (txtPhoneNumber.getText().length() >= 10) {
                        evt.consume();
              }
    }//GEN-LAST:event_txtPhoneNumberKeyTyped

    private void txtPasswordKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPasswordKeyTyped
              int key = evt.getKeyChar();
              boolean validCharacters = (key >= 65 && key <= 90) || (key >= 97 && key <= 122) || (key == 32) || (key >= 48 && key <= 57);
              if (!validCharacters) {
                        evt.consume();
              }
    }//GEN-LAST:event_txtPasswordKeyTyped

    private void btnCreateUserActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCreateUserActionPerformed
              ArrayList<User> users = new ArrayList<User>();
              User user = new User();
              UserdbController userdbController = new UserdbController();
              String collectionName = "Users";
              int option = JOptionPane.showConfirmDialog(this, "Do you want to continue?");
              if (option == 0) {
                        if (txtFullName.getText().isEmpty()
                                || txtMail.getText().isEmpty()
                                || txtPassword.getText().isEmpty()
                                || txtPhoneNumber.getText().isEmpty()) {
                                  JOptionPane.showMessageDialog(null, "Error, algunos campos estan vacios");
                        } else {

                                  userdbController = UserdbController.connectToDatabase(userdbController);

                                  user = new User(txtFullName.getText(), txtMail.getText(), Long.parseLong(txtPhoneNumber.getText()), txtUserName.getText(), txtPassword.getText());
                                  users.add(user);
                                  TraveldbController.createOne(user, userdbController.getDatabase(), collectionName);
                                  JOptionPane.showMessageDialog(null, "El usuario ha sido creado con exito");
                                  clean();

                        }
              }
    }//GEN-LAST:event_btnCreateUserActionPerformed

    private void btnCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelActionPerformed

              FrmUserLogin login = new FrmUserLogin();
              this.setVisible(false);

              login.setVisible(true);
              clean();
    }//GEN-LAST:event_btnCancelActionPerformed

    private void txtUserNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtUserNameActionPerformed
    }//GEN-LAST:event_txtUserNameActionPerformed

    private void btBackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btBackActionPerformed
              FrmUserLogin frmUserLogin;
              frmUserLogin = new FrmUserLogin();
              this.setVisible(false);
              frmUserLogin.setVisible(true);
    }//GEN-LAST:event_btBackActionPerformed

          /**
           * @param args the command line arguments
           */
          public static void main(String args[]) {
                    /* Set the Nimbus look and feel */
                    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
                    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
                     */
                    try {
                              for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                                        if ("Nimbus".equals(info.getName())) {
                                                  javax.swing.UIManager.setLookAndFeel(info.getClassName());
                                                  break;
                                        }
                              }
                    } catch (ClassNotFoundException ex) {
                              java.util.logging.Logger.getLogger(FrmUserRegister.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
                    } catch (InstantiationException ex) {
                              java.util.logging.Logger.getLogger(FrmUserRegister.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
                    } catch (IllegalAccessException ex) {
                              java.util.logging.Logger.getLogger(FrmUserRegister.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
                    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
                              java.util.logging.Logger.getLogger(FrmUserRegister.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
                    }
                    //</editor-fold>
                    //</editor-fold>

                    /* Create and display the form */
                    java.awt.EventQueue.invokeLater(new Runnable() {
                              public void run() {
                                        new FrmUserRegister().setVisible(true);
                              }
                    });
          }

          // Variables declaration - do not modify//GEN-BEGIN:variables
          private javax.swing.JButton btBack;
          private javax.swing.JButton btnCancel;
          private javax.swing.JButton btnCreateUser;
          private javax.swing.JLabel jLabel1;
          private javax.swing.JLabel jLabel2;
          private javax.swing.JLabel jLabel3;
          private javax.swing.JLabel jLabel4;
          private javax.swing.JLabel jLabel5;
          private javax.swing.JLabel jLabel6;
          private javax.swing.JPanel jPanel1;
          private javax.swing.JTextField txtFullName;
          private javax.swing.JTextField txtMail;
          private javax.swing.JTextField txtPassword;
          private javax.swing.JTextField txtPhoneNumber;
          private javax.swing.JTextField txtUserName;
          // End of variables declaration//GEN-END:variables

          private void clean() {
                    txtFullName.setText("");
                    txtMail.setText("");
                    txtPassword.setText("");
                    txtPhoneNumber.setText("");
          }
}
